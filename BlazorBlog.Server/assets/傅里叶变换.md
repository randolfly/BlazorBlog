---
aliases: 
tags: [def, 信号, 傅里叶变换, fft, DFT, DTFT]
title: 傅里叶变换
date created: June 1st 2022, 12:06:11 pm
date modified: August 4th 2022, 3:16:57 pm
---
# 傅里叶变换

## 定义

傅里叶变换的本质是：从空间 ([[希尔伯特空间]]) 中找一组正交基向 $E_x = 3$ 量或者正交基函数。

$$e_k(t)=\frac{e^{-ikt}}{\sqrt{2 \pi}}$$

其中希尔伯特空间中的内积定义为：对于向量 f,g，有：

$$<f,g> := \int_{a}^{b} f(t) \bar{g(t)} dt$$

容易证明，对上面提出的正交基向量满足：

$$(e_j(t), e_k(t)) = \int_{-\pi}^{\pi} e^{-i(j-k)t}dt = 0, \forall j\neq k$$

因此在空间中使用这组选区的正交基，将时域信号投影到这组正交基上，有傅里叶变换：

$$\hat{f(k)} = \frac{1}{2 \pi} \int_{-\infty}^{\infty} f(t)e^{-ikt} dt = <f,e_k(t)>$$

> #todo : DFT, FFT 之间联系

同样的，对于离散傅里叶变换 DFT，一样的思路：

$$X(k+1) = \sum_{n=0}^{N-1} x(n+1) e^{-j\frac{2 \pi}{N}nk}$$

## 例子

使用 matlab 的 fft 函数 (快速傅里叶变换，实现 DFT 的一种快速算法) 将一段矩形信号进行变换。通常我们得到幅值频率图像，可以看到对应频率的幅值。



代码参考：[[fft_signal_process.m]]

将离散频率对应的正交基向量绘制起来，对信号进行重构，得到下图：

![](Pasted%20image%2020210806145050.png)



## 频谱分辨率

**频率分辨率** 简言之就是区分两个不同频率的能力。

假设信号的采样频率为 _Fs_, _T=N*Fs_ 反映的是信号总时长，在频域上，我们可以得到 _N_ 个频率（基向量），可以理解为 _Fs_ 被 _N_ 个值平分，因此频率的分辨率为 $\frac{F_s}{N}=\frac{1}{T}$。我们从上面推导可以知道频率分辨率由采样时长决定，如果采样时长太短，DFT 没有能力区分两个接近的频率值。

## 频谱泄露

通过两个频率组成的正弦信号来分析频谱泄露。

这两种正弦波的频率分别为 f1 = 100Hz 和 f2 = 202.5 Hz。采样率为 1000Hz，信号长度为 1000 个采样点（T=1s）。
我们期望的结果是频谱幅值只在 f1 = 100Hz 和 f2 = 202.5Hz 处的结果不为零，其他位置的频谱幅值为零。

但真实结果是这样的：



也就是在 202.5Hz 的信号幅值被周围的频率值平分了，这种现象就是频谱泄露。

从频谱分辨率的角度解释通过上面的结论：我们得到 DFT 的频率分辨率为 1/T = 1Hz，对于 f1 = 100Hz 正好落在分辨率的分仓边界上，而 f2 = 202.5Hz 不能被分辨率 1Hz 取整。

从时域角度解释：我们取了窗口时间 1s 长度的数据，对应 f1 的 100 个完整周期以及 f2 的 202.5 个周期，DFT 默认信号是采样时间窗内周期出现的无限长信号，因此当窗重复时对于 f1 来说正好是整数拼接，与原信号完全一致，而 f2 在上一个 1s 采样时间窗结束时并非对应信号自身周期结束，如下图：



所以在上一个周期和下一个周期之间的信号过渡时有一个突变 (周期边界由黑色虚线表示)。这个突变导致信号中添加了除原始频率之外的其他频率。这就解释了频谱泄露现象。

频谱泄露会让我们在计算频域幅值时不够准确，因为能量幅值被周围的频率平分。了解了频谱泄露的原因，我们可以通过==调整采样时长==，保证在每个时间窗口中都有原始信号的整数个周期，例如设置采样窗口 T = 2s(保证所有信号都是整数周期截断)。

然而通常我们可能未必能对真实数据进行延长采样，可以考虑==补零 zero-padding== 的方式。你可以用补零来对 DFT 进行插值。

> 补零可以获得更准确的幅值估计。补零并不能提高 DFT 的谱 (频率) 分辨率。

根据这种方法，将 DFT 要处理的信号用 0 补长到 2000 个点。有了这个长度，DFT 分仓之间的间距是 F_s=0.5Hz，在这种情况下，202.5Hz 正弦波的能量直接落在 DFT 分仓中。获得 DFT 并绘制振幅估计值得到更准确的幅值。



## 参考

- [MATLAB 中的振动分析与信号处理 —— 传统信号处理 (qq.com)](https://mp.weixin.qq.com/s/5tHMZEbf580PJK9Xy57jdA)
- [Amplitude Estimation and Zero Padding - MATLAB & Simulink (mathworks.com)](https://www.mathworks.com/help/releases/R2020b/signal/ug/amplitude-estimation-and-zero-padding.html)
